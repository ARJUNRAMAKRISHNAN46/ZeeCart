<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

    <style>
        body {
            font-family: Arial, sans-serif;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table,
        th,
        td {
            border: 1px solid black;
        }

        th,
        td {
            padding: 10px;
            text-align: left;
        }
    </style>
</head>

<body>
    <div class="d-flex justify-content-center align-items-center"
        style="background: rgb(90, 90, 90);color: white;padding: 15px;">

        <h1
            style="font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;">
            Sales Report <%= `${startDate.toLocaleDateString()} ${startDate.toLocaleTimeString()} to ${endDate.toLocaleDateString()} ${endDate.toLocaleTimeString()}` %>

        </h1>
    </div>

    <table>
        <thead>
            <tr style="background: rgb(255, 205, 174);">
                <th>User ID</th>
                <th>Order ID</th>
                <th>Date</th>
                <th>Total Amount</th>
                <th>Payment Method</th>
            </tr>
        </thead>
        <tbody>
            <% orders.forEach(order=> { %>
                <tr style="background: rgb(255, 254, 191);">
                    <td>
                        <%= order.userId %>
                    </td>
                    <td>
                        <%= order._id %>
                    </td>
                    <td>
                        <%= order.orderDate.toLocaleDateString() || 'N/A' %>
                            <%=order.orderDate.toLocaleTimeString() || 'N/A' %>
                    </td>
                    <td>
                        <%= order.totalAmount.toFixed(2) %>
                    </td>
                    <td>
                        <%= order.paymentMethod %>
                    </td>
                </tr>
                <% }); %>
        </tbody>
        <tr style="background: rgb(216, 255, 185);">
            <td></td>
            <td></td>
            <td></td>
            <td style="font-weight: 600;">Total Sales : </td>
            <%if(totalSales) {%>
                <td>â‚¹<%= totalSales.toFixed(2) %>
                </td>
                <%}else{%>
                    <td>No Sales Found</td>
                    <%}%>
        </tr>
    </table>
</body>

</html>